var carousel_all,controls_all,carousel_now,controls_now;var qs_match=location.search.match(/product=(\w+)/i);var product_preselect=qs_match?qs_match[1]:"";
var slide_preselect=0;jQuery(document).ready(function(){$("html,body").animate({scrollTop:185},300);$(".notes-wrapper .notes").each(function(h){$wrap=$(this).parent();
if($(this).outerHeight()>$wrap.height()){$wrap.height($(this).outerHeight());}});$("html,body").animate({scrollTop:185},300);if(cart_is_active){Shopify.getCart(function(h){if(typeof(h.item_count)!="undefined"){updateCartCount(h.item_count);
}});}$("div.carousel img[data-src]:not([src])").each(function(){var i=$(this).data("src");$(this).attr("src",i);var h=$('<div class="slide"></div>');h.css("background-image","url('"+i+"')");
$(this).wrap(h);});product_preselect=$('div.carousel[data-value="'+product_preselect+'"]').length===1?product_preselect:"";if(product_preselect===""){product_preselect=Cookies.get("lastPencilCarousel")||"";
if(product_preselect>""){slide_preselect=parseInt(Cookies.get("lastPencilSlide")||"0");}}if(product_preselect===""){product_preselect=$("div.carousel[data-value]").first().data("value");
}$("div.carousel").each(function(m){var l=$(this).data("value");var n=(product_preselect===l);var o=$(this).find("div.slide").length;var p=slide_preselect<=o-1?slide_preselect:o-1;
$(this).find("div.slide").eq(p).addClass("active").show();var k=$('<div class="carousel-controls" data-value="'+l+'"></div>');if(!n){k.hide();}for(var h=0;
h<o;h++){var j=$('<a href="#">'+h+"</a>");if(h===p){j.addClass("active");}k.append(j);}$(this).after(k);if(n){$(this).fadeIn("fast");}});carousel_all=$("div.carousel");
controls_all=$("div.carousel-controls");carousel_now=carousel_all.filter(":visible").first();controls_now=controls_all.filter(":visible").first();var g=function(h){if(carousel_now.data("value")===h){return;
}carousel_all.each(function(l){if($(this).data("value")===h){var n=$(this);var m=controls_all.eq(l);var k=n.find("div.slide.active").index();var j=carousel_now.find("div.slide.active").index();
if(k>j){n.find("div.slide").eq(k).removeClass("active").hide();n.find("div.slide").eq(j).addClass("active").show();m.find("a").eq(k).removeClass("active");
m.find("a").eq(j).addClass("active");k=j;}carousel_now.fadeOut();n.fadeIn();controls_now.fadeOut();m.fadeIn();carousel_now=n;controls_now=m;Cookies.set("lastPencilCarousel",h);
Cookies.set("lastPencilSlide",k);}});};var d=function(h){controls_all.each(function(){var k=$(this);var m=k.find("a.active").index();var j=k.find("a").length-1;
var l=h>j?j:h;if(l===m){return true;}var i=k.find("a").eq(m);var n=k.find("a").eq(l);i.removeClass("active");n.addClass("active");});};var c=function(h){carousel_all.each(function(){var m=$(this);
var n=m.find("div.slide.active").index();var i=m.find("div.slide").length-1;var j=h>i?i:h;if(j===n){return true;}var l=m.find("div.slide").eq(n);var k=m.find("div.slide").eq(j);
l.removeClass("active");k.addClass("active").fadeIn(function(){l.hide();});Cookies.set("lastPencilSlide",j);});};var e=function(){var h=carousel_now.find("div.slide.active").index()-1;
var i=carousel_now.find("div.slide").length-1;h=h<0?i:h;c(h);d(h);};var f=function(){var h=carousel_now.find("div.slide.active").index()+1;var i=carousel_now.find("div.slide").length-1;
h=h>i?0:h;c(h);d(h);};$("div.carousel-controls a").on("click",function(i){i.preventDefault();if($(this).hasClass("active")){return false;}var h=parseInt($(this).text());
c(h);d(h);return false;});$("div.carousel-gestures").on("click",function(h){f();});$("div.carousel-gestures").hammer({swipe_velocity:0.5}).on("swipeleft",function(h){f();
});$("div.carousel-gestures").hammer({swipe_velocity:0.5}).on("swiperight",function(h){e();});var b=function(n){var k=$("p.price:visible");if(k.data("value")!=n){var m=$("p.price[data-value='"+n+"']");
m.fadeIn("fast");k.fadeOut("fast");}var j=$("aside form:visible");if(j.data("value")!=n){var l=$("aside form[data-value='"+n+"']");l.fadeIn("fast");j.fadeOut("fast");
}var h=$(".notes-wrapper .notes[data-value]:visible");if(h.data("value")!=n){var i=$(".notes-wrapper .notes[data-value='"+n+"']");i.fadeIn("fast");h.fadeOut("fast");
}};var a=function(j){var i=$("a.swatch.active");if(i.data("value")===j){return;}var h=$("a.swatch[data-value='"+j+"']");i.removeClass("active");h.addClass("active");
};if(product_preselect>""){b(product_preselect);a(product_preselect);}$("a.swatch").on("click",function(i){i.preventDefault();var h=$(this).data("value");
a(h);b(h);g(h);return false;});$("div.faq > a").on("click",function(h){h.preventDefault();$(this).toggleClass("expanded");$(this).siblings("p").slideToggle();
return false;});$("select.placeholder").on("change",function(h){if(this.selectedIndex>0){$(this).removeClass("placeholder");$(this).children("option").first().remove();
$(this).off("change");}});$("div.form-wrapper form").submit(function(h){var i=parseInt($(this).data("id"));$.ajax({dataType:"json",url:"/cart.js",async:false,success:function(m,n,l){if(typeof(m.items)!="undefined"){for(var j=0;
j<m.items.length;j++){var k=m.items[j];if(i===m.items[j].variant_id){location.href="/cart";h.preventDefault();return false;}}}},complete:function(j,k){return true;
}});});});